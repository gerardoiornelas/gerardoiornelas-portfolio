<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="760" viewBox="0 0 1200 760" role="img" aria-labelledby="title desc">
  <title id="title">Authority Flow for Safe Agent Execution</title>
  <desc id="desc">Flow diagram showing user intent, policy issuance, cryptographic sealing, APP verifier checks, and allow or deny outcomes.</desc>
  <defs>
    <style>
      .bg { fill: #f7fafc; }
      .panel { fill: #ffffff; stroke: #0f172a; stroke-width: 2; rx: 14; }
      .text { fill: #0f172a; font-family: Helvetica, Arial, sans-serif; font-size: 26px; }
      .small { fill: #334155; font-family: Helvetica, Arial, sans-serif; font-size: 21px; }
      .title { fill: #0b1324; font-family: Helvetica, Arial, sans-serif; font-size: 40px; font-weight: 700; }
      .allow { fill: #065f46; font-family: Helvetica, Arial, sans-serif; font-size: 24px; font-weight: 700; }
      .deny { fill: #991b1b; font-family: Helvetica, Arial, sans-serif; font-size: 24px; font-weight: 700; }
      .line { stroke: #1e293b; stroke-width: 3; fill: none; }
      .line2 { stroke: #1e293b; stroke-width: 2; fill: none; stroke-dasharray: 7 7; }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#1e293b"/>
    </marker>
  </defs>

  <rect class="bg" x="0" y="0" width="1200" height="760"/>
  <text class="title" x="50" y="62">Authority Flow for Safe Agent Execution (APP)</text>

  <rect class="panel" x="430" y="100" width="340" height="80"/>
  <text class="text" x="525" y="150">User Intent</text>

  <rect class="panel" x="370" y="230" width="460" height="100"/>
  <text class="text" x="470" y="278">Policy Issuer</text>
  <text class="small" x="402" y="308">Creates least-privilege, task-scoped authority</text>

  <rect class="panel" x="330" y="380" width="540" height="100"/>
  <text class="text" x="420" y="428">Cryptographic Sealing</text>
  <text class="small" x="394" y="458">Sign with Ed25519 and encrypt with X25519 + AEAD</text>

  <rect class="panel" x="280" y="530" width="640" height="130"/>
  <text class="text" x="530" y="572">APP Verifier</text>
  <text class="small" x="320" y="604">Decrypt, verify signature, validate audience, intent/scope, and expiration</text>

  <rect class="panel" x="980" y="560" width="180" height="70"/>
  <text class="allow" x="1018" y="604">ALLOW</text>

  <rect class="panel" x="40" y="560" width="180" height="70"/>
  <text class="deny" x="78" y="604">DENY</text>

  <line class="line" x1="600" y1="180" x2="600" y2="230" marker-end="url(#arrow)"/>
  <line class="line" x1="600" y1="330" x2="600" y2="380" marker-end="url(#arrow)"/>
  <line class="line" x1="600" y1="480" x2="600" y2="530" marker-end="url(#arrow)"/>
  <line class="line" x1="920" y1="595" x2="980" y2="595" marker-end="url(#arrow)"/>
  <line class="line2" x1="280" y1="595" x2="220" y2="595" marker-end="url(#arrow)"/>

  <text class="small" x="70" y="690">Core rule: no tool action executes without explicit, verifiable, encrypted policy.</text>
</svg>
